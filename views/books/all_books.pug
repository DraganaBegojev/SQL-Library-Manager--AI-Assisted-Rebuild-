extends ../layout

block content
  h1 Books
  .create-search-container
    a.button(href='/books/new') Create New Book
    form(method='get', style='display: flex; align-items: center; gap: 6px;')
      input(
        type='search',
        id='search',
        name='search',
        placeholder='Search...',
        value=(typeof search !== 'undefined' ? search : '')
      )
      button.search-btn(type='submit') Search

  table
    thead
      tr
        th Title
        th Author
        th Genre
        th Year Released
    tbody
      if books && books.length
        each book in books
          tr
            td
              a(href=`/books/${book.id}`)= book.title
            td= book.author
            td= book.genre
            td= book.first_published
      else
        tr
          td(colspan='4') No results found

  if typeof totalPages !== 'undefined' && totalPages > 1
    nav.pagination
      ul
        - const base = (search ? `?search=${encodeURIComponent(search)}&` : '?');
        li
          - const prevPage = page - 1;
          a(href=`${base}page=${Math.max(1, prevPage)}`) Previous
        - for (let i = 1; i <= totalPages; i++) {
          li(class=(i === page ? 'active' : ''))
            a(href=`${base}page=${i}`)= i
        - }
        li
          - const nextPage = page + 1;
          a(href=`${base}page=${Math.min(totalPages, nextPage)}`) Next