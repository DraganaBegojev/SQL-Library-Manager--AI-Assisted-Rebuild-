extends ../layout

block content
  h1 Patrons
  .create-search-container
    a.button(href='/patrons/new') Create New Patron
    form(method='get', style='display: flex; align-items: center; gap: 6px;')
      input(
        type='search',
        id='search',
        name='search',
        placeholder='Search...',
        value=(typeof search !== 'undefined' ? search : '')
      )
      button.search-btn(type='submit') Search

  table
    thead
      tr
        th Name
        th Address
        th Email
        th Library ID
        th Zip
    tbody
      if patrons && patrons.length
        each patron in patrons
          tr
            td
              a(href=`/patrons/${patron.id}`)= `${patron.first_name} ${patron.last_name}`
            td= patron.address
            td= patron.email
            td= patron.library_id
            td= patron.zip_code
      else
        tr
          td(colspan='5') No results found

  if typeof totalPages !== 'undefined' && totalPages > 1
    nav.pagination
      ul
        - const base = (search ? `?search=${encodeURIComponent(search)}&` : '?');
        li
          - const prevPage = page - 1;
          a(href=`${base}page=${Math.max(1, prevPage)}`) Previous
        - for (let i = 1; i <= totalPages; i++) {
          li(class=(i === page ? 'active' : ''))
            a(href=`${base}page=${i}`)= i
        - }
        li
          - const nextPage = page + 1;
          a(href=`${base}page=${Math.min(totalPages, nextPage)}`) Next
